alerts:
- key: capture_transaction_5xx_alert
  category_path:
  - capture_the_transaction
  name: capture-transaction-5xx-alert
  description: 'API Capture Transaction: 5xx error count exceeded (> 2 in 5m)'
  query: |-
    AppRequests
    | where Name matches regex @"^PUT /idpay-itn/merchant-op/transactions/bar-code/[^/]+/capture$"
    | where ResultCode startswith "5"
  trigger:
    operator: GreaterThanOrEqual
    threshold: 2
  email_subject: '[PARI][ESE][HIGH] Capture Transaction API Alert (5xx)'
- key: capture_transaction_4xx_alert
  category_path:
  - capture_the_transaction
  name: capture-transaction-4xx-auth-alert
  description: 'API Capture Transaction: 401/404/429 error count exceeded (> 20 in
    5m)'
  query: |-
    AppRequests
    | where Name matches regex @"^PUT /idpay-itn/merchant-op/transactions/bar-code/[^/]+/capture$"
    | where ResultCode in ("401", "404", "429")
  trigger:
    operator: GreaterThanOrEqual
    threshold: 20
  email_subject: '[PARI][ESE][HIGH] Capture Transaction API Alert (4xx)'
- key: preview_payment_5xx_alert
  category_path:
  - preview_payment
  name: preview-payment-5xx-alert
  description: 'API Preview Payment: 5xx error count exceeded (> 2 in 5m)'
  query: |-
    AppRequests
    | where Name matches regex @"^PUT /idpay-itn/merchant-op/transactions/bar-code/[^/]+/preview$"
    | where ResultCode startswith "5"
  trigger:
    operator: GreaterThanOrEqual
    threshold: 2
  email_subject: '[PARI][ESE][HIGH] Preview Payment API Alert (5xx)'
- key: preview_payment_4xx_alert
  category_path:
  - preview_payment
  name: preview-payment-4xx-auth-alert
  description: 'API Preview Payment: 401/429 error count exceeded (> 20 in 5m)'
  query: |-
    AppRequests
    | where Name matches regex @"^PUT /idpay-itn/merchant-op/transactions/bar-code/[^/]+/preview$"
    | where ResultCode in ("401", "429")
  trigger:
    operator: GreaterThanOrEqual
    threshold: 20
  email_subject: '[PARI][ESE][HIGH] Preview Payment API Alert (4xx)'
- key: authorize_payment_5xx_alert
  category_path:
  - authorize_payment
  name: authorize-payment-5xx-alert
  description: 'API Authorize Payment: 5xx error count exceeded (> 2 in 5m)'
  query: |-
    AppRequests
    | where Name matches regex @"^PUT /idpay-itn/merchant-op/transactions/bar-code/[^/]+/authorize$"
    | where ResultCode startswith "5"
  trigger:
    operator: GreaterThanOrEqual
    threshold: 2
  email_subject: '[PARI][ESE][HIGH] Authorize Payment API Alert (5xx)'
- key: authorize_payment_4xx_alert
  category_path:
  - authorize_payment
  name: authorize-payment-4xx-auth-alert
  description: 'API Authorize Payment: 401/403/404/429 error count exceeded (> 20
    in 5m)'
  query: |-
    AppRequests
    | where Name matches regex @"^PUT /idpay-itn/merchant-op/transactions/bar-code/[^/]+/authorize$"
    | where ResultCode in ("401", "403", "404", "429")
  trigger:
    operator: GreaterThanOrEqual
    threshold: 20
  email_subject: '[PARI][ESE][HIGH] Authorize Payment API Alert (4xx)'
- key: pos_transactions_list_5xx_alert
  category_path:
  - pos_in_progress_transactions_list
  name: pos-transactions-inprogress-list-5xx-alert
  description: 'API POS In Progress Transactions List: 5xx error count exceeded (>
    2 in 5m)'
  query: |-
    AppRequests
    | where Name matches regex @"^GET /idpay-itn/merchant-op/initiatives/[^/]+/point-of-sales/[^/]+/transactions$"
    | where ResultCode startswith "5"
  trigger:
    operator: GreaterThanOrEqual
    threshold: 2
  email_subject: '[PARI][ESE][HIGH] POS In Progress Transactions List API Alert (5xx)'
- key: pos_transactions_list_4xx_alert
  category_path:
  - pos_in_progress_transactions_list
  name: pos-transactions-inprogress-list-4xx-alert
  description: 'API POS In Progress Transactions List: 401/404/429 error count exceeded
    (> 5 in 5m)'
  query: |-
    AppRequests
    | where Name matches regex @"^GET /idpay-itn/merchant-op/initiatives/[^/]+/point-of-sales/[^/]+/transactions$"
    | where ResultCode in ("401", "404", "429")
  trigger:
    operator: GreaterThanOrEqual
    threshold: 5
  email_subject: '[PARI][ESE][HIGH] POS In Progress Transactions List API Alert (4xx)'
- key: pos_transactions_processed_5xx_alert
  category_path:
  - pos_processed_transactions_list
  name: pos-transactions-processed-5xx-alert
  description: 'API POS Processed Transactions List: 5xx error count exceeded (> 2
    in 5m)'
  query: |-
    AppRequests
    | where Name matches regex @"^GET /idpay-itn/merchant-op/initiatives/[^/]+/point-of-sales/[^/]+/transactions/processed$"
    | where ResultCode startswith "5"
  trigger:
    operator: GreaterThanOrEqual
    threshold: 2
  email_subject: '[PARI][ESE][HIGH] POS Processed Transactions List API Alert (5xx)'
- key: pos_transactions_processed_4xx_alert
  category_path:
  - pos_processed_transactions_list
  name: pos-transactions-processed-4xx-alert
  description: 'API POS Processed Transactions List: 401/404/429 error count exceeded
    (> 5 in 5m)'
  query: |-
    AppRequests
    | where Name matches regex @"^GET /idpay-itn/merchant-op/initiatives/[^/]+/point-of-sales/[^/]+/transactions/processed$"
    | where ResultCode in ("401", "404", "429")
  trigger:
    operator: GreaterThanOrEqual
    threshold: 5
  email_subject: '[PARI][ESE][HIGH] POS Processed Transactions List API Alert (4xx)'
- key: delete_transaction_5xx_alert
  category_path:
  - delete_transaction
  name: delete-transaction-5xx-alert
  description: 'API Delete Transaction: 5xx error count exceeded (> 2 in 5m)'
  severity: 3
  query: |-
    AppRequests
    | where Name matches regex @"^DELETE /idpay-itn/merchant-op/transactions/[^/]+$"
    | where ResultCode startswith "5"
  trigger:
    operator: GreaterThanOrEqual
    threshold: 2
  email_subject: '[PARI][ESE][LOW] Delete Transaction API Alert (5xx)'
- key: delete_transaction_4xx_alert
  category_path:
  - delete_transaction
  name: delete-transaction-4xx-alert
  description: 'API Delete Transaction: 401/403/404/429 error count exceeded (> 5
    in 5m)'
  severity: 3
  query: |-
    AppRequests
    | where Name matches regex @"^DELETE /idpay-itn/merchant-op/transactions/[^/]+$"
    | where ResultCode in ("401", "403", "404", "429")
  trigger:
    operator: GreaterThanOrEqual
    threshold: 5
  email_subject: '[PARI][ESE][LOW] Delete Transaction API Alert (4xx)'
- key: reversal_transaction_5xx_alert
  category_path:
  - reversal_transaction
  name: reversal-transaction-5xx-alert
  description: 'API Reversal Transaction: 5xx error count exceeded (> 2 in 5m)'
  query: |-
    AppRequests
    | where Name matches regex @"^POST /idpay-itn/merchant-op/transactions/[^/]+/reversal$"
    | where ResultCode startswith "5"
  trigger:
    operator: GreaterThanOrEqual
    threshold: 2
  email_subject: '[PARI][ESE][HIGH] Reversal Transaction API Alert (5xx)'
- key: reward_transaction_5xx_alert
  category_path:
  - reward_transaction
  name: reward-transaction-5xx-alert
  description: 'API Reward Transaction: 5xx error count exceeded (> 2 in 5m)'
  query: |-
    AppRequests
    | where Name matches regex @"^POST /idpay-itn/merchant-op/transactions/[^/]+/reward$"
    | where ResultCode startswith "5"
  trigger:
    operator: GreaterThanOrEqual
    threshold: 2
  email_subject: '[PARI][ESE][HIGH] Reward Transaction API Alert (5xx)'
- key: products_list_5xx_alert
  category_path:
  - products_list
  name: products-list-5xx-alert
  description: 'API Products List: 5xx error count exceeded (> 2 in 5m)'
  query: |-
    AppRequests
    | where Name == "GET /idpay-itn/merchant-op/products"
    | where ResultCode startswith "5"
  trigger:
    operator: GreaterThanOrEqual
    threshold: 2
  email_subject: '[PARI][ESE][HIGH] Products List API Alert (5xx)'
- key: products_list_4xx_alert
  category_path:
  - products_list
  name: products-list-4xx-alert
  description: 'API Products List: 401/404/429 error count exceeded (> 15 in 5m)'
  query: |-
    AppRequests
    | where Name == "GET /idpay-itn/merchant-op/products"
    | where ResultCode in ("401", "404", "429")
  trigger:
    operator: GreaterThanOrEqual
    threshold: 15
  email_subject: '[PARI][ESE][HIGH] Products List API Alert (4xx)'
