alerts:
- key: keycloak_token_merchant_operator_realm_alert
  name: keycloak-token-merchant-operator-realm-alert
  description: 'Keycloak (/token ''merchant-operator'' realm): Total failure count
    exceeded (> 5 in 5m)'
  data_source: core_app_insights
  query_template: |-
    requests
    | where appName == "%s"
    | where tostring(customDimensions.["kc.realmName"]) in ("merchant-operator")
    | where not(operation_Name has "admin")
    | where name == "POST /realms/{realm}/protocol/{protocol}/token"
    | where success == false
  query_template_args:
  - core_app_insights
  trigger:
    operator: GreaterThanOrEqual
    threshold: 5
  email_subject: '[PARI][KEYCLOAK][HIGH] Keycloak /token ''merchant-operator'' Realm
    Alert (Failures)'
