alerts:
- key: get_wallet_5xx_alert
  category_path:
  - get_wallet
  name: get-wallet-5xx-alert
  description: 'API Get Wallet: 5xx error count exceeded (> 3 in 5m)'
  severity: 2
  query: |-
    AppRequests
    | where Name == "GET /idpay-itn/wallet/"
    | where ResultCode startswith "5"
  trigger:
    operator: GreaterThanOrEqual
    threshold: 3
  email_subject: '[PARI][UPBE][MEDIUM] Get Wallet API Alert (5xx)'
- key: get_initiative_beneficiary_detail_5xx_alert
  category_path:
  - get_initiative_beneficiary_detail
  name: get-initiative-beneficiary-detail-5xx-alert
  description: 'API Get Initiative Beneficiary Detail: 5xx error count exceeded (>
    5 in 5m)'
  severity: 2
  query: |-
    AppRequests
    | where Name matches regex @"^GET /idpay-itn/wallet/[^/]+/detail$"
    | where ResultCode startswith "5"
  trigger:
    operator: GreaterThanOrEqual
    threshold: 5
  email_subject: '[PARI][UPBE][MEDIUM] Get Initiative Beneficiary Detail API Alert
    (5xx)'
- key: get_initiative_beneficiary_detail_400_alert
  category_path:
  - get_initiative_beneficiary_detail
  name: get-initiative-beneficiary-detail-400-alert
  description: 'API Get Initiative Beneficiary Detail: 400 error count exceeded (>
    50 in 10m)'
  severity: 2
  time_window: 10
  query: |-
    AppRequests
    | where Name matches regex @"^GET /idpay-itn/wallet/[^/]+/detail$"
    | where ResultCode == "400"
  trigger:
    operator: GreaterThanOrEqual
    threshold: 50
  email_subject: '[PARI][UPBE][MEDIUM] Get Initiative Beneficiary Detail API Alert
    (400)'
- key: get_initiative_beneficiary_detail_4xx_auth_alert
  category_path:
  - get_initiative_beneficiary_detail
  name: get-initiative-beneficiary-detail-4xx-auth-alert
  description: 'API Get Initiative Beneficiary Detail: 401/429 error count exceeded
    (> 5 in 5m)'
  severity: 2
  query: |-
    AppRequests
    | where Name matches regex @"^GET /idpay-itn/wallet/[^/]+/detail$"
    | where ResultCode in ("401", "429")
  trigger:
    operator: GreaterThanOrEqual
    threshold: 5
  email_subject: '[PARI][UPBE][MEDIUM] Get Initiative Beneficiary Detail API Alert
    (401/429)'
- key: get_wallet_detail_5xx_alert
  category_path:
  - get_wallet_detail
  name: get-wallet-detail-5xx-alert
  description: 'API Get Wallet Detail: 5xx error count exceeded (> 5 in 5m)'
  query: |-
    AppRequests
    | where Name matches regex @"^GET /idpay-itn/wallet/[^/]+$"
    | where ResultCode startswith "5"
  trigger:
    operator: GreaterThanOrEqual
    threshold: 5
  email_subject: '[PARI][UPBE][HIGH] Get Wallet Detail API Alert (5xx)'
- key: get_wallet_detail_400_alert
  category_path:
  - get_wallet_detail
  name: get-wallet-detail-400-alert
  description: 'API Get Wallet Detail: 400 error count exceeded (> 50 in 10m)'
  time_window: 10
  query: |-
    AppRequests
    | where Name matches regex @"^GET /idpay-itn/wallet/[^/]+$"
    | where ResultCode == "400"
  trigger:
    operator: GreaterThanOrEqual
    threshold: 50
  email_subject: '[PARI][UPBE][HIGH] Get Wallet Detail API Alert (400)'
- key: get_wallet_detail_4xx_auth_alert
  category_path:
  - get_wallet_detail
  name: get-wallet-detail-4xx-auth-alert
  description: 'API Get Wallet Detail: 401/429 error count exceeded (> 5 in 5m)'
  query: |-
    AppRequests
    | where Name matches regex @"^GET /idpay-itn/wallet/[^/]+$"
    | where ResultCode in ("401", "429")
  trigger:
    operator: GreaterThanOrEqual
    threshold: 5
  email_subject: '[PARI][UPBE][HIGH] Get Wallet Detail API Alert (401/429)'
