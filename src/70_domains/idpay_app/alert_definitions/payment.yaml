alerts:
- key: create_barcode_transaction_5xx_alert
  category_path:
  - create_barcode_transaction
  name: create-barcode-transaction-5xx-alert
  description: 'API Create Barcode Transaction: 5xx error count exceeded (> 5 in 5m)'
  query: |-
    AppRequests
    | where Name == "POST /idpay-itn/payment/bar-code"
    | where ResultCode startswith "5"
  trigger:
    operator: GreaterThanOrEqual
    threshold: 5
  email_subject: '[PARI][UPBE][HIGH] Create Barcode Transaction API Alert (5xx)'
- key: create_barcode_transaction_400_alert
  category_path:
  - create_barcode_transaction
  name: create-barcode-transaction-400-alert
  description: 'API Create Barcode Transaction: 400 error count exceeded (> 50 in
    10m)'
  time_window: 10
  query: |-
    AppRequests
    | where Name == "POST /idpay-itn/payment/bar-code"
    | where ResultCode == "400"
  trigger:
    operator: GreaterThanOrEqual
    threshold: 50
  email_subject: '[PARI][UPBE][HIGH] Create Barcode Transaction API Alert (400)'
- key: create_barcode_transaction_4xx_auth_alert
  category_path:
  - create_barcode_transaction
  name: create-barcode-transaction-4xx-auth-alert
  description: 'API Create Barcode Transaction: 401/429 error count exceeded (> 5
    in 5m)'
  query: |-
    AppRequests
    | where Name == "POST /idpay-itn/payment/bar-code"
    | where ResultCode in ("401", "429")
  trigger:
    operator: GreaterThanOrEqual
    threshold: 5
  email_subject: '[PARI][UPBE][HIGH] Create Barcode Transaction API Alert (401/429)'
- key: retrieve_active_barcode_transaction_5xx_alert
  category_path:
  - retrieve_active_barcode_transaction
  name: retrieve-active-barcode-transaction-5xx-alert
  description: 'API Retrieve Active Barcode Transaction: 5xx error count exceeded
    (> 5 in 5m)'
  query: |-
    AppRequests
    | where Name matches regex @"^GET /idpay-itn/payment/initiatives/[^/]+/bar-code$"
    | where ResultCode startswith "5"
  trigger:
    operator: GreaterThanOrEqual
    threshold: 5
  email_subject: '[PARI][UPBE][HIGH] Retrieve Active Barcode Transaction API Alert
    (5xx)'
- key: retrieve_active_barcode_transaction_400_alert
  category_path:
  - retrieve_active_barcode_transaction
  name: retrieve-active-barcode-transaction-400-alert
  description: 'API Retrieve Active Barcode Transaction: 400 error count exceeded
    (> 50 in 10m)'
  time_window: 10
  query: |-
    AppRequests
    | where Name matches regex @"^GET /idpay-itn/payment/initiatives/[^/]+/bar-code$"
    | where ResultCode == "400"
  trigger:
    operator: GreaterThanOrEqual
    threshold: 50
  email_subject: '[PARI][UPBE][HIGH] Retrieve Active Barcode Transaction API Alert
    (400)'
- key: retrieve_active_barcode_transaction_4xx_auth_alert
  category_path:
  - retrieve_active_barcode_transaction
  name: retrieve-active-barcode-transaction-4xx-auth-alert
  description: 'API Retrieve Active Barcode Transaction: 401/429 error count exceeded
    (> 5 in 5m)'
  query: |-
    AppRequests
    | where Name matches regex @"^GET /idpay-itn/payment/initiatives/[^/]+/bar-code$"
    | where ResultCode in ("401", "429")
  trigger:
    operator: GreaterThanOrEqual
    threshold: 5
  email_subject: '[PARI][UPBE][HIGH] Retrieve Active Barcode Transaction API Alert
    (401/429)'
